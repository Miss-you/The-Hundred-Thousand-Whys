# 网络

## 按照标准的 TCP 协议栈以及状态机，一个连接什么情况下会发 RST 包给对端？

## GSO 是什么东西？

## 跨域是什么？

如果一个页面中的 JS 可以任意发起 http 跨域获取其他页面上的资源，这是一件很可怕的事，比如：

- 张三访问了某银行网站 abank.com，服务器端验证后会在响应头中加入 Set-Cookie 字段，然后下次张三再发起请求，浏览器会自动将 cookie 附加在 HTTP 请求的首部字段 Cookie 中，服务器端就知道张三已经登录过了。
- 张三接着访问了危险页面 danger.com，这个页面中写了一些 Ajax，它发起请求访问 abank.com，这一行为用户不能察觉，如果可以跨域发起请求，那么浏览器同样会自动将 cookie 附加在 HTTP 请求的首部字段 Cookie 中，这样这个危险危险网站就登陆了张三的银行账户。

所以在互联网中，需要同源策略限制跨域，不同源的资源如果没有获取相应权限则不可以由其他源站的访问。http 服务器中的跨域可以类比于 http 服务器中的黑白名单，前者是对 http 请求源站、http 请求访问内容进行限制，而后者则是对请求源 ip/目的 ip 进行限制。

那么，什么时候是跨域什么时候是同源呢？

- http 请求协议相同
- http 请求域名相同
- http 请求端口相同

便是同源，反正则是跨域

## NAT 技术有什么用？

NAT 技术能够重写 IP 数据包的源 IP 或目的 IP，所以普遍用来解决公网 IP 地址短缺的问题。它可以让网络中的多台主机，通过共享同一个公网 IP 地址，来访问外网资源。同时，由于 NAT 屏蔽了内网网络，也为局域网中机器起到安全隔离的作用。

## http1.1 和 http2 的历史意义

引入任何一种新技术都是有原因和目的的。比如 HTTP keep-alive 允许客户端和服务端用同一个 TCP 连接发送/接收多个请求/响应，减少了昂贵的 TCP 建立连接和断开连接的过程；HTTP pipelining 允许客户端在收到响应之前继续发送幂等方法（GET 和 HEAD）的请求，提升在高延迟连接下页面的加载速度；HTTP/2 更是定义了帧（frame）和流（stream），真正地复用了 TCP 连接，从而解决了 pipelining 不能解决的问题（例如「快」的响应被「慢」的响应阻塞的问题）。

## 高防 IP 与 WAF 的区别？

高防 IP 是防护 DDoS 攻击的，主要用于 4 层。
WAF 主要是防护 CC 攻击的，主要用于 7 层。

## DDos 是什么？

分布式拒绝服务（Distributed Denial of Service，DDoS），即分布式拒绝服务攻击，是指攻击者通过网络远程控制大量僵尸主机向一个或多个目标发送大量攻击请求，堵塞目标服务器的网络带宽或耗尽目标服务器的系统资源，导致其无法响应正常的服务请求。

## net.inet.ip.forwarding 配置有什么用？

该配置是 ipv4 报文路由转发

路由转发是做啥的？当电脑开启路由转发功能的时候，电脑收到目标地址不是自己电脑的 IP 地址，不会丢掉，反而会进行路由搜索，发送给目标地址机器（如果能搜索到的话）或者是发送给电脑的相应指定网关或者默认网关

## A 类、B 类、C 类地址

### 1、什么是 A 类、B 类、C 类地址？

IP 地址有三种基本类型，由网络号的第一组数字来表示。

A 类地址的第一组数字为 1～126。注意，数字 0 和 127 不作为 A 类地址，数字 127 保留给内部回送函数，而数字 0 则表示该地址是本地宿主机，不能传送。

B 类地址的第一组数字为 128～191。

C 类地址的第一组数字为 192～223。

**例如：我校的网络号是 202.206.64--79 ，它的第一组数字为 202，因此 202.206.64.34 是 C 类地址。而 159.266.1.1 则是 B 类地址。**

目前 IP 地址资源较紧张，向 INTERNET 亚太中心能申请到的大多是 C 类地址。

### 2、私有地址
上面提到 IP 地址在全世界范围内唯一，看到这句话你可能有这样的疑问，像 192.168.0.1 这样的地址在许多地方都能看到，并不唯一，这是为何？Internet 管理委员会规定如下地址段为私有地址，私有地址可以自己组网时用，但不能在 Internet 网上用，Internet 网没有这些地址的路由，有这些地址的计算机要上网必须转换成为合法的 IP 地址，也称为公网地址，这就像有很到的世界公园，每个公园内都可命名相同的大街，如香榭丽舍大街，但对外我们只能看到公园的地址和真正的香榭丽舍大街。下面是 A、B、C 类网络中的私有地址段。你自己组网时就可以用这些地址了。

```
   10.0.0.0～10.255.255.255

   172.16.0.0～172.131.255.255

   192.168.0.0～192.168.255.255
   
   ```

### 3、回送地址

   A 类网络地址 127 是一个保留地址，用于网络软件测试以及本地机进程间通信，叫做回送地址（loopbackaddress）。无论什么程序，一旦使用回送地址发送数据，协议软件立即返回之，不进行任何网络传输。含网络号 127 的分组不能出现在任何网络上。

`小技巧：`

Ping127.0.0.1, 如果反馈信息失败，说明 IP 协议栈有错，必须重新安装 TCP/IP 协议。如果成功，ping 本机 IP 地址，如果反馈信息失败，说明你的网卡不能和 IP 协议栈进行通信。 
如果网卡没接网线，用本机的一些服务如 Sql Server、IIS 等就可以用 127.0.0.1 这个地址。

### 4、广播地址

   TCP/IP 规定，主机号全为"1"的网络地址用于广播之用，叫做广播地址。所谓广播，指同时向同一子网所有主机发送报文。

### 5、网络地址

TCP/IP 协议规定，各位全为"0"的网络号被解释成"本"网络。由上可以看出：一、含网络号 127 的分组不能出现在任何网络上；二、主机和网关不能为该地址广播任何寻径信息。由以上规定可以看出，主机号全"0"全"1"
的地址在 TCP/IP 协议中有特殊含义，一般不能用作一台主机的有效地址。

### 6、子网掩码

   从上面的例子可以看出，子网掩码的作用就是和 IP 地址与运算后得出网络地址，子网掩码也是 32bit，并且是一串 1 后跟随一串 0 组成，其中 1 表示在 IP 地址中的网络号对应的位数，而 0 表示在 IP 地址中主机对应的位数。

1）标准子网掩码

A 类网络（1 - 126） 缺省子网掩码：255·0·0·0

255·0·0·0 换算成二进制为 11111111·00000000·00000000·00000000

   可以清楚地看出前 8 位是网络地址，后 24 位是主机地址，也就是说，如果用的是标准子网掩码，看第一段地址即可看出是不是同一网络的。如 21.0.0.0.1 和 21.240.230.1，第一段为 21 属于 A 类，如果用的是默认的子网掩码，那这两个地址就是一个网段的。

    B 类网络（128 -191） 缺省子网掩码：255·255·0·0

    C 类网络（192 -223） 缺省子网掩码：255·255·255·0

   B 类、C 类分析同上。

## ICMP 使用什么端口

> ICMP 使用什么端口？PING 操作又是使用什么端口？

1. ICMP 是 Internet 控制信息协议（ICMP），是 IP 组的一个整合部分。通过 IP 包传送的 ICMP 信息主要用户涉及网络操作或错误操作的不可达信息。ICMP 包发送是不可靠的，所以主机不能依靠接收 ICMP 包解决任何网络问题。ICMP 不像 TCP/UDP 有端口，但它确实含有两个域：类型 type 和代码 code。但是这个域的作用与 TCP/UDP 的端口作用也完全不同。
2. Ping 用到了 ICMP 协议

> 延伸：关于 ICMP echo (PING 操作）

1. 首先查询本地 arp cache 信息，看是否有对方的 mac 地址和 IP 地址映射条目记录
2. 如果没有，则发起一个 arp 请求广播包，等待对方告知具体的 mac 地址
3. 收到 arp 相应包之后，获得某个 IP 对应的具体 mac 地址，有了物理地址之后才可以开始通信了，同时对 ip-mac 地址做一个本地 cache
4. 发出 icmp echo request 包，收到 icmp echo reply